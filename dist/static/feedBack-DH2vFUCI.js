import{d as j,a as v,u as U,l as P,b as s,o as B,n as V,f as l,c as e,w as n,i as d,t as r,s as R,F as A,j as k,x,E as b,p as G,k as H,_ as J}from"./index-BeHN7UMk.js";const c=u=>(G("data-v-26e227b8"),u=u(),H(),u),K=c(()=>l("div",{class:"shadow-border title-container"},"用户反馈意见",-1)),L={class:"table-container"},O={style:{display:"flex"}},Q={style:{"margin-left":"20px",display:"flex","justify-content":"center","align-items":"center"}},W=c(()=>l("p",null,"已处理：",-1)),X={key:0,class:"detail-container"},Y=c(()=>l("h3",null,"反馈详情",-1)),Z=c(()=>l("strong",null,"反馈序号:",-1)),ee=c(()=>l("strong",null,"反馈用户:",-1)),te=c(()=>l("strong",null,"反馈时间:",-1)),le=c(()=>l("strong",null,"使用模型:",-1)),oe=c(()=>l("strong",null,"使用数据文件:",-1)),ae=c(()=>l("strong",null,"有疑问的组件:",-1)),ne=c(()=>l("strong",null,"问题描述:",-1)),se=j({__name:"feedBack",setup(u){const m=v([]),g=U(),a=v({id:0,username:"",model:"",datafile:"",module:"",question:"",status:"",time:"",processed:!1}),w=()=>{k.get("administration/fetch_feedbacks/").then(t=>{if(t.data.code==401)x.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:()=>{g.push("/")}});else if(t.data.code==200){let i=t.data.data;m.length=0;for(let o of i)m.push({...o,processed:o.status==="已处理"})}}).catch(()=>{b.error("获取用户反馈失败，请稍后重试")})};P(()=>{w()});const S=(t,i)=>{k.get("administration/delete_feedbacks/?feedbackId="+i.id).then(o=>{o.data.code==401?x.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:()=>{g.push("/")}}):o.data.code==200&&t!==-1&&m.splice(t,1)}).catch(()=>{b.error("删除用户反馈失败，请稍后重试")})},D=t=>{const i=t.processed?"已处理":"待处理";let o=new FormData;o.append("feedbackId",String(t.id)),o.append("newStatus",i),k.post("administration/update_feedback_status/",o).then(f=>{f.data.code==401?x.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:()=>{g.push("/")}}):f.data.code==200&&(t.status=i,b.success("反馈状态更新成功"))}).catch(()=>{b.error("更新反馈状态失败，请稍后重试"),t.processed=!t.processed})},F=t=>{a.id=t.id,a.username=t.username,a.model=t.model,a.datafile=t.datafile,a.module=t.module,a.question=t.question,a.status=t.status,a.time=t.time};return(t,i)=>{const o=s("el-table-column"),f=s("Delete"),y=s("el-icon"),h=s("el-button"),C=s("el-col"),I=s("el-row"),q=s("el-popconfirm"),z=s("View"),E=s("el-tooltip"),N=s("el-checkbox"),T=s("el-table"),$=s("el-scrollbar");return B(),V(A,null,[K,l("div",L,[e(T,{data:m,style:{width:"100%"},height:"100%",stripe:!0,"header-cell-style":{backgroundColor:"#f5f7fa",color:"#606266"},border:"","empty-text":"暂无数据"},{default:n(()=>[e(o,{prop:"username",label:"反馈用户"}),e(o,{prop:"time",label:"反馈时间"}),e(o,{prop:"model",label:"使用模型"}),e(o,{prop:"datafile",label:"使用数据文件"}),e(o,{prop:"module",label:"有疑问的组件"}),e(o,{prop:"status",label:"处理状态"}),e(o,{label:"操作",width:"250px"},{default:n(_=>[l("div",O,[e(q,{title:"你确定要删除该条反馈吗?",onConfirm:p=>S(_.$index,_.row),width:"100px"},{reference:n(()=>[e(h,{size:"large",type:"danger",circle:"",plain:"",style:{"margin-right":"10px"}},{default:n(()=>[e(y,null,{default:n(()=>[e(f)]),_:1})]),_:1})]),actions:n(({confirm:p,cancel:M})=>[e(I,null,{default:n(()=>[e(C,{span:12},{default:n(()=>[e(h,{size:"small",onClick:M},{default:n(()=>[d("取消")]),_:2},1032,["onClick"])]),_:2},1024),e(C,{span:12},{default:n(()=>[e(h,{type:"primary",size:"small",onClick:p},{default:n(()=>[d(" 确定 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onConfirm"]),e(E,{content:"查看反馈详情",placement:"top",effect:"light"},{default:n(()=>[e(h,{size:"large",type:"primary",plain:"",circle:"",onClick:p=>F(_.row)},{default:n(()=>[e(y,null,{default:n(()=>[e(z)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),l("span",Q,[W,e(N,{modelValue:_.row.processed,"onUpdate:modelValue":p=>_.row.processed=p,onChange:p=>D(_.row),style:{"margin-left":"10px"}},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]),_:1})]),_:1},8,["data"])]),a.id?(B(),V("div",X,[e($,{height:"100%"},{default:n(()=>[Y,l("p",null,[Z,d(" "+r(a.id),1)]),l("p",null,[ee,d(" "+r(a.username),1)]),l("p",null,[te,d(" "+r(a.time),1)]),l("p",null,[le,d(" "+r(a.model),1)]),l("p",null,[oe,d(" "+r(a.datafile),1)]),l("p",null,[ae,d(" "+r(a.module),1)]),l("p",null,[ne,d(" "+r(a.question),1)])]),_:1})])):R("",!0)],64)}}}),de=J(se,[["__scopeId","data-v-26e227b8"]]);export{de as default};
