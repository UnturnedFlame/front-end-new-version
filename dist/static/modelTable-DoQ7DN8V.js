import{_ as H,r,l as K,j as I,x as T,E as B,n as y,f as n,c as t,w as l,u as Q,b as a,o as m,i,F as A,A as F,e as W,t as V,p as X,k as Y}from"./index-BeHN7UMk.js";import{l as Z}from"./constant-CsPomWco.js";const N=f=>(X("data-v-c8f81f85"),f=f(),Y(),f),ee={style:{display:"flex","flex-direction":"column"}},te=N(()=>n("div",{class:"shadow-border title-container",style:{}},"用户模型管理",-1)),oe={class:"roleManage"},le={class:"tableTool",style:{position:"relative",width:"100%",height:"30px"}},ae={style:{position:"absolute",right:"12%",display:"flex","flex-direction":"row"}},se={style:{display:"flex","flex-direction":"row","margin-right":"20px"}},ne={style:{display:"flex","flex-direction":"row","margin-right":"20px"}},ie=N(()=>n("span",{style:{width:"100px",display:"flex","align-items":"center","justify-content":"center"}},"选择关键字",-1)),de={class:"table-container"},re=N(()=>n("span",{style:{"font-size":"20px"}},"确定删除该模型吗？",-1)),ce={__name:"modelTable",setup(f){const b=r(""),x=r("username"),U=()=>{I.get("administration/search_model/?keywords="+b.value+"&keywordType="+x.value).then(o=>{if(o.data.code==401)T.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:e=>{w.push("/")}});else if(o.data.code==200){c.value.length=0;for(let e of o.data.result)c.value.push(e)}}).catch(o=>{message.error("搜索失败，请重试")})},c=r([]),w=Q();K(()=>{L()});const L=()=>{I.get("/administration/fetch_users_models/").then(o=>{if(o.data.code==401)T.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:e=>{w.push("/")}});else{let e=o.data;c.value.length=0;for(let d of e)c.value.push(d)}}).catch(o=>{B.error("获取用户模型信息失败，请稍后重试")})};let k=0,j=0;const _=r(!1),D=(o,e)=>{k=o,j=e,_.value=!0},E=r(""),S=r([]),C=r([]),J=o=>{let e=JSON.parse(o.model_info);console.log("showModelInfo objects: ",e);let d=e.nodeList.nodes;console.log("------",d);let M=e.modelConfig.modules;E.value=o.model_name,S.value=M,C.value.length=0,d.forEach(h=>{let p={模块名:"",算法:""};p.模块名=h.nodeInfo.label,p.算法=Z[h.nodeInfo.use_algorithm],C.value.push(p)})},O=()=>{I.get("/administration/delete_user_model/?row_id="+j.id).then(o=>{o.data.message==="delete user model success"&&k!==-1&&(c.value.splice(k,1),_.value=!1,B({message:"模型删除成功",type:"success"})),o.data.code==401&&T.alert("登录状态已失效，请重新登陆","提示",{confirmButtonText:"确定",callback:e=>{w.push("/")}})}).catch(o=>{B({message:"删除失败，请稍后重试",type:"error"}),console.error(o)})};return(o,e)=>{const d=a("a-select-option"),M=a("a-select"),h=a("a-input"),p=a("a-button"),z=a("el-popover"),v=a("el-table-column"),g=a("el-button"),P=a("el-tag"),$=a("el-descriptions-item"),R=a("el-descriptions"),q=a("el-table"),G=a("el-dialog");return m(),y("div",ee,[te,n("div",oe,[n("div",le,[n("div",ae,[n("span",se,[n("div",ne,[ie,t(M,{style:{width:"110px"},value:x.value,"onUpdate:value":e[0]||(e[0]=s=>x.value=s)},{default:l(()=>[t(d,{value:"username"},{default:l(()=>[i("作者")]),_:1}),t(d,{value:"modelname"},{default:l(()=>[i("模型名称")]),_:1})]),_:1},8,["value"])]),t(h,{value:b.value,"onUpdate:value":e[1]||(e[1]=s=>b.value=s),placeholder:"按关键字搜索"},null,8,["value"]),t(p,{onClick:U},{default:l(()=>[i("搜索")]),_:1})])])])]),n("div",de,[t(q,{data:c.value,stripe:"",style:{width:"100%"},height:"500px",border:"","empty-text":"暂无数据","header-cell-style":{backgroundColor:"#f5f7fa",color:"#606266"}},{default:l(()=>[t(z,{placement:"bottom-start",title:"模型信息",width:400,trigger:"hover",content:"这是模型信息"}),t(v,{property:"model_name",label:"模型名称"}),t(v,{property:"author",label:"作者"}),t(v,{property:"jobNumber",label:"工号"}),t(v,{label:"操作"},{default:l(s=>[t(g,{size:"small",type:"danger",style:{width:"50px"},onClick:u=>D(s.$index,s.row)},{default:l(()=>[i(" 删除 ")]),_:2},1032,["onClick"]),t(z,{placement:"bottom",width:500,trigger:"click"},{reference:l(()=>[t(g,{size:"small",type:"info",style:{width:"80px"},onClick:u=>J(s.row)},{default:l(()=>[i(" 查看模型 ")]),_:2},1032,["onClick"])]),default:l(()=>[t(R,{title:E.value,column:3,direction:"vertical"},{default:l(()=>[t($,{label:"使用模块",span:3},{default:l(()=>[(m(!0),y(A,null,F(S.value,u=>(m(),W(P,{size:"small"},{default:l(()=>[i(V(u),1)]),_:2},1024))),256))]),_:1}),t($,{label:"算法参数",span:3},{default:l(()=>[(m(!0),y(A,null,F(C.value,u=>(m(),y("div",null,V(u.模块名)+": "+V(u.算法),1))),256))]),_:1})]),_:1},8,["title"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),t(G,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=s=>_.value=s),title:"提示",width:"500"},{footer:l(()=>[t(g,{style:{width:"150px"},onClick:e[2]||(e[2]=s=>_.value=!1)},{default:l(()=>[i("取消")]),_:1}),t(g,{style:{width:"150px","margin-right":"70px"},type:"primary",onClick:O},{default:l(()=>[i("确定")]),_:1})]),default:l(()=>[re]),_:1},8,["modelValue"])])}}},pe=H(ce,[["__scopeId","data-v-c8f81f85"]]);export{pe as default};
