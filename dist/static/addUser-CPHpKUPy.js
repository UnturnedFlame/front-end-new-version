import{r as c,a as U,e as k,w as r,u as z,b as s,o as C,f as V,c as l,i as p,j as h,E as f}from"./index-BeHN7UMk.js";const F={class:"button-container"},$={class:"buttons-right-bottom"},d="140px",Z={__name:"addUser",setup(q){const g=z(),m=c(null),i=c(!0),o=U({username:"",password:"",role:"user",jobNumber:"",email:""}),w={username:[{required:!0,message:"用户姓名不能为空",trigger:"blur"},{min:3,max:10,message:"用户姓名长度必须在3到10个字符之间",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:8,message:"密码长度必须至少为8位",trigger:"blur"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/,message:"密码必须包含数字、大小写字母",trigger:"blur"}],jobNumber:[{required:!0,message:"工号不能为空",trigger:"blur"},{min:5,max:10,message:"工号长度必须在5到10个字符之间",trigger:"blur"},{pattern:/^\d{5,10}$/,message:"工号必须为5到10位数字",trigger:"blur"}],email:[{required:!1,message:"",trigger:"blur"},{pattern:/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,message:"邮箱格式不正确",trigger:"blur"}]},v=u=>{u&&(u.resetFields(),i.value=!1,g.push("/admin/userManage"))},y=async()=>{try{if(await m.value.validate()){let e=JSON.stringify(o);h.post("administration/add_user/",e).then(t=>{t.data.message==="add user success"?(f({message:"用户创建成功",type:"success"}),m.value.resetFields(),i.value=!1,g.push("/admin/userManage")):f({message:"用户创建失败,"+t.data.message,type:"error"})}).catch(t=>{console.error("请求错误：",t),f.error("服务器出错，请稍微重试")})}else{console.error("表单验证失败");return}}catch(u){console.error("创建用户失败",u)}};return(u,e)=>{const t=s("el-input"),n=s("el-form-item"),b=s("el-radio"),x=s("el-radio-group"),N=s("el-form"),_=s("el-button"),j=s("el-dialog");return C(),k(j,{modelValue:i.value,"onUpdate:modelValue":e[7]||(e[7]=a=>i.value=a),title:"新增用户",width:"500",onClose:e[8]||(e[8]=()=>{o.username="",o.password=""}),"show-close":!1,"close-on-click-modal":!1,center:""},{footer:r(()=>[V("div",F,[V("div",$,[l(_,{onClick:e[5]||(e[5]=a=>v(m.value))},{default:r(()=>[p("取消")]),_:1}),l(_,{type:"primary",onClick:e[6]||(e[6]=a=>y())},{default:r(()=>[p("确定")]),_:1})])])]),default:r(()=>[l(N,{model:o,rules:w,ref_key:"formRef",ref:m,style:{"margin-right":"70px"}},{default:r(()=>[l(n,{prop:"jobNumber",label:"工号","label-width":d},{default:r(()=>[l(t,{modelValue:o.jobNumber,"onUpdate:modelValue":e[0]||(e[0]=a=>o.jobNumber=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(n,{prop:"username",label:"用户名","label-width":d},{default:r(()=>[l(t,{modelValue:o.username,"onUpdate:modelValue":e[1]||(e[1]=a=>o.username=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(n,{prop:"password",label:"密码","label-width":d},{default:r(()=>[l(t,{modelValue:o.password,"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),autocomplete:"off",placeholder:"密码须包含数字、大小写字母"},null,8,["modelValue"])]),_:1}),l(n,{prop:"email",label:"邮箱","label-width":d},{default:r(()=>[l(t,{modelValue:o.email,"onUpdate:modelValue":e[3]||(e[3]=a=>o.email=a),autocomplete:"off",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(n,{prop:"role",label:"角色权限","label-width":d},{default:r(()=>[l(x,{modelValue:o.role,"onUpdate:modelValue":e[4]||(e[4]=a=>o.role=a),style:{"padding-left":"10px"}},{default:r(()=>[l(b,{label:"user",size:"large"},{default:r(()=>[p("普通用户")]),_:1}),l(b,{label:"superuser",size:"large"},{default:r(()=>[p("系统用户")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}};export{Z as default};
